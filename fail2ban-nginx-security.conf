# Fail2ban filter for Nginx security violations
# Combines rate limiting (429), forbidden access (403), and auth failures (401)
# Path: /etc/fail2ban/filter.d/nginx-security.conf

[Definition]

# Detect rate limiting violations (429)
# Example: [error] 1811654#1811654: *183643 limiting requests, excess: 5.115 by zone "auth_zone", client: 172.71.172.125
#
# Detect forbidden access attempts (403)
# Example: [error] 1811654#1811654: *184043 access forbidden by rule, client: 138.197.154.111
#
# These patterns match Nginx error log format

failregex = ^\s*\[[a-z]+\] \d+#\d+: \*\d+ limiting requests, excess: [\d\.]+ by zone \"[^\"]+\", client: <HOST>,
            ^\s*\[[a-z]+\] \d+#\d+: \*\d+ access forbidden by rule, client: <HOST>,

ignoreregex = 

# Nginx error log date pattern
datepattern = {^LN-BEG}
